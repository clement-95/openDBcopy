<?xml version="1.0" encoding="UTF-8"?>

<!-- =============================================================== -->
<!-- Ant build file                                              -->
<!-- =============================================================== -->

<project name="opendbcopy" default="compile" basedir=".">

   <property name="basedir" value="."/>
   <property name="build.compiler" value="modern"/>
   <property name="build.sysclasspath" value="ignore"/>

   <property name="name" value="opendbcopy"/>
   <property name="version" value="0.41"/>

   <property name="sources" value="${basedir}/src"/>
   <property name="lib" value="${basedir}/lib"/>
   <property name="build" value="${basedir}/classes"/>
   <property name="javadoc" value="${basedir}/docs/javadoc"/>

   <property name="packages" value="opendbcopy.*"/>

   <!-- ============================================================= -->
   <!-- Classpath with libraries needed to compile this application   -->
   <!-- ============================================================= -->
   <path id="compile.classpath">
      <fileset dir="${lib}">
         <include name="**/*.zip"/>
         <include name="**/*.jar"/>
      </fileset>
   </path>

   <!-- ============================================================= -->
   <!-- Prepares the project                                          -->
   <!-- ============================================================= -->
   <target name="prepare">
      <mkdir dir="${build}"/>
      <mkdir dir="${lib}"/>
   </target>

   <!-- ============================================================= -->
   <!-- Compiles the source code                                      -->
   <!-- ============================================================= -->
   <target name="compile" depends="prepare">

      <javac srcdir="${sources}"
         destdir="${build}"
         debug="on"
         optimize="on">
         <classpath refid="compile.classpath"/>
      </javac>

   </target>

   <!-- ============================================================= -->
   <!-- Clean up all files that are generated.                        -->
   <!-- ============================================================= -->
   <target name="clean">
      <delete quiet="true" dir="${build}"/>
   </target>

   <!-- ============================================================= -->
   <!-- Clean and then compile the project                            -->
   <!-- ============================================================= -->
   <target name="rebuild">
      <antcall target="clean"/>
      <antcall target="compile"/>
   </target>

   <!-- ============================================================= -->
   <!-- Create the jar file                                           -->
   <!-- ============================================================= -->
   <target name="jar" depends="compile">
      <jar jarfile="${lib}/${name}.jar">
         <fileset dir="${build}"/>
      </jar>
   </target>

   <!-- ============================================================= -->
   <!-- Create the zip file                                           -->
   <!-- ============================================================= -->
   <target name="zip">
      <zip zipfile="../opendbcopy.zip" basedir="."></zip>
   </target>

   <!-- ============================================================= -->
   <!-- Execute opendbcopy                                      	    -->
   <!-- ============================================================= -->
   <target name="run" depends="compile">
      <java classname="opendbcopy.controller.MainController" fork="true">
         <sysproperty key="ant_opts" value="mx512m"/>
         <classpath>
            <pathelement location="./"/>
            <pathelement location="${build}"/>
            <fileset dir="${lib}">
               <include name="**/*.jar"/>
			   <include name="**/*.zip"/>
            </fileset>
         </classpath>
      </java>
   </target>

   <!-- ============================================================= -->
   <!-- Creates the API documentation                                 -->
   <!-- ============================================================= -->
   <target name="javadoc" depends="compile">
      <mkdir dir="${javadoc}"/>
      <javadoc packagenames="${packages}"
         sourcepath="${sources}"
         destdir="${javadoc}"
         author="true"
         version="true"
         windowtitle="opendbcopy API"
         doctitle="opendbcopy"
         bottom="Copyright &#169; 2003 by Anthony Smith, Puzzle ITC GmbH, see LICENCE"
         />
   </target>

</project>
