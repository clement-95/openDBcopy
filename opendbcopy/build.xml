<?xml version="1.0" encoding="UTF-8"?>

<!-- =============================================================== -->
<!-- Ant build file                                              -->
<!-- =============================================================== -->

<project name="opendbcopy" default="compile" basedir=".">

   	<property name="basedir" value="."/>
   	<property name="build.compiler" value="modern"/>
   	<property name="build.sysclasspath" value="ignore"/>

   	<property name="name" value="opendbcopy"/>
   	<property name="version" value="0.41.1"/>

   	<property name="sources.dir" value="${basedir}/src"/>
   	<property name="lib.dir" value="${basedir}/lib"/>
   	<property name="build.dir" value="${basedir}/classes"/>
   	<property name="dist.dir" value="${basedir}/dist"/>
   	<property name="javadoc.dir" value="${basedir}/apidocs"/>
   	<property name="izpack.dir" value="c:/Programme/IzPack"/>

   	<property name="packages" value="opendbcopy.*"/>
   
	<taskdef name="izpack" classpath="${izpack.dir}/lib/compiler.jar"
		classname="com.izforge.izpack.ant.IzPackTask"/>

   	<!-- ============================================================= -->
   	<!-- Classpath with libraries needed to compile this application   -->
   	<!-- ============================================================= -->
   	<path id="compile.classpath">
      	<fileset dir="${lib.dir}">
         	<include name="**/*.zip"/>
         	<include name="**/*.jar"/>
      	</fileset>
   	</path>

   	<!-- ============================================================= -->
   	<!-- Prepares the project                                          -->
   	<!-- ============================================================= -->
   	<target name="prepare">
      	<mkdir dir="${build.dir}"/>
      	<mkdir dir="${lib.dir}"/>
   	</target>

   	<!-- ============================================================= -->
   	<!-- Compiles the source code                                      -->
   	<!-- ============================================================= -->
   	<target name="compile" depends="prepare">

    	<javac srcdir="${sources.dir}"
         	destdir="${build.dir}"
         	debug="on"
         	optimize="on">
         	<classpath refid="compile.classpath"/>
      	</javac>

   	</target>

   	<!-- ============================================================= -->
   	<!-- Clean up all files that are generated.                        -->
   	<!-- ============================================================= -->
   	<target name="clean">
      	<delete quiet="true" dir="${build.dir}"/>
   	</target>

   	<!-- ============================================================= -->
   	<!-- Clean and then compile the project                            -->
   	<!-- ============================================================= -->
   	<target name="rebuild">
      	<antcall target="clean"/>
      	<antcall target="compile"/>
   	</target>

   	<!-- ============================================================= -->
   	<!-- Create the jar file                                           -->
   	<!-- ============================================================= -->
   	<target name="jar" depends="compile">
      	<jar jarfile="${lib.dir}/${name}.jar">
         	<fileset dir="${build.dir}"/>
      	</jar>
   	</target>

   	<!-- ============================================================= -->
   	<!-- Create the zip file                                           -->
   	<!-- ============================================================= -->
   	<target name="zip">
      	<zip zipfile="../opendbcopy.zip" basedir="."></zip>
   	</target>
   
	<!-- ============================================================= -->
   	<!-- Execute opendbcopy                                      	    -->
   	<!-- ============================================================= -->
   	<target name="run" depends="compile">
      	<java classname="opendbcopy.controller.MainController" fork="true">
         	<sysproperty key="ant_opts" value="mx512m"/>
         	<classpath>
            	<pathelement location="./"/>
            	<pathelement location="${build.dir}"/>
            	<fileset dir="${lib.dir}">
               		<include name="**/*.jar"/>
			   		<include name="**/*.zip"/>
            	</fileset>
         	</classpath>
      	</java>
   	</target>

   	<!-- ============================================================= -->
   	<!-- Create IzPack installable jar                                 -->
   	<!-- ============================================================= -->
	<target name="installer" depends="jar">
		<izpack input="install.xml"
			output="${dist.dir}/${name}-${version}-install.jar"
			installerType="standard-kunststoff"
			basedir="${basedir}"
			izPackDir="${izpack.dir}"/>		
	</target>
	
   	<!-- ============================================================= -->
   	<!-- Creates the API documentation                                 -->
   	<!-- ============================================================= -->
   	<target name="javadoc" depends="compile">
      	<mkdir dir="${javadoc.dir}"/>
      	<javadoc packagenames="${packages}"
         	sourcepath="${sources.dir}"
         	destdir="${javadoc.dir}"
         	author="true"
         	version="true"
         	windowtitle="opendbcopy API 0.41"
         	doctitle="opendbcopy"
         	bottom="Copyright &#169; 2004 by Anthony Smith, Puzzle ITC GmbH"
        />
   </target>

</project>
